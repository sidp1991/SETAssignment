# Importing the libraries
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
# Importing the dataset
df=pd.read_csv('AirQualityUCI.csv')
# Shape of dataset
df.shape
# Using isna() function to check NaN values in dataframe
df.isna()
# Drop columns which are not necessary
df=df.drop(['Date','Time','Unnamed: 15','Unnamed: 16'],axis=1)
df.shape
# Remove rows which has null vlaues
df=df.dropna()
df.columns
df['CO(GT)'].value_counts()
# Replace negative values in dataframe with 0
num = df._get_numeric_data()
num[num < 0] = 0
df['CO(GT)'].value_counts()
Independant_variables=df.drop(['C6H6(GT)'],axis=1)
Dependant_variable=df['C6H6(GT)']
# train test split
X_train,X_test,y_train,y_test=train_test_split(Independant_variables,Dependant_variable,test_size=0.3)
print(X_train.shape,y_train.shape)
print(X_test.shape,y_test.shape)
# Fitting Linear Regression to the dataset
model=LinearRegression()
model.fit(X_train,y_train)
model.score(X_test,y_test)
y_pred = model.predict(X_test)
print("Predicted values:")
print(y_pred)
mean_squared_error(y_test,y_pred)
